---
interface Props {
  title: string;
  description: string;
  slug: string;
  clientName?: string;
  originalUrl?: string;
  technologies: string[];
  image?: string;
  featured?: boolean;
}

const {
  title,
  description,
  slug,
  clientName,
  originalUrl,
  technologies,
  image,
  featured = false,
} = Astro.props;

// Color mapping for technology badges (same as ProjectCard)
const techColors: Record<string, { bg: string; text: string }> = {
  'React Native': { bg: 'bg-accent-100', text: 'text-accent-700' },
  'React': { bg: 'bg-primary-100', text: 'text-primary-700' },
  'TypeScript': { bg: 'bg-primary-100', text: 'text-primary-700' },
  'JavaScript': { bg: 'bg-yellow-100', text: 'text-yellow-700' },
  'Node.js': { bg: 'bg-green-100', text: 'text-green-700' },
  'PostgreSQL': { bg: 'bg-blue-100', text: 'text-blue-700' },
  'MongoDB': { bg: 'bg-green-100', text: 'text-green-700' },
  'GraphQL': { bg: 'bg-pink-100', text: 'text-pink-700' },
  'Next.js': { bg: 'bg-neutral-800', text: 'text-neutral-100' },
  'Tailwind CSS': { bg: 'bg-cyan-100', text: 'text-cyan-700' },
  'Astro': { bg: 'bg-orange-100', text: 'text-orange-700' },
  'Expo': { bg: 'bg-neutral-100', text: 'text-neutral-700' },
  'Firebase': { bg: 'bg-amber-100', text: 'text-amber-700' },
  'AWS': { bg: 'bg-orange-100', text: 'text-orange-700' },
  'HTML': { bg: 'bg-orange-100', text: 'text-orange-700' },
  'CSS': { bg: 'bg-blue-100', text: 'text-blue-700' },
  'default': { bg: 'bg-neutral-100', text: 'text-neutral-700' },
};

const getColors = (tech: string) => techColors[tech] || techColors['default'];
---

<article class:list={[
  'card overflow-hidden transition-shadow hover:shadow-lg',
  featured && 'ring-2 ring-accent-500 ring-offset-2'
]}>
  {image && (
    <div class="aspect-video bg-neutral-100 overflow-hidden">
      <img
        src={image}
        alt={`${title} screenshot`}
        class="w-full h-full object-cover"
        loading="lazy"
      />
    </div>
  )}

  <div class="p-6">
    <div class="flex items-start justify-between gap-4 mb-3">
      <h3 class="text-xl font-semibold text-neutral-900">{title}</h3>
      {featured && (
        <span class="px-2 py-0.5 text-xs font-medium bg-accent-500 text-white rounded flex-shrink-0">
          Featured
        </span>
      )}
    </div>

    {clientName && (
      <p class="text-sm text-neutral-500 mb-2">
        Client: {clientName}
      </p>
    )}

    <p class="text-neutral-600 mb-4">{description}</p>

    <div class="flex flex-wrap gap-2 mb-5">
      {technologies.map((tech) => {
        const colors = getColors(tech);
        return (
          <span class={`px-2.5 py-1 text-xs font-medium rounded-full ${colors.bg} ${colors.text}`}>
            {tech}
          </span>
        );
      })}
    </div>

    <div class="flex flex-wrap gap-3 pt-4 border-t border-neutral-100">
      <a
        href={`/demo/${slug}`}
        class="inline-flex items-center text-sm font-medium text-primary-600 hover:text-primary-700"
      >
        <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
        </svg>
        View Demo
      </a>
      {originalUrl && (
        <a
          href={originalUrl}
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center text-sm font-medium text-neutral-600 hover:text-neutral-900"
        >
          <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
          </svg>
          Original Site
        </a>
      )}
    </div>
  </div>
</article>
